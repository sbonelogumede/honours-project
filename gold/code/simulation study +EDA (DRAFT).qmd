---
title: "SIMULATION STUDY"
format: pdf
editor: visual
---

**Exploratory Data Analysis and Simulation Design (CHAPTER 4)**

To build a simulation that closely replicates the empirical characteristics of the gold-like closing price dataset, we performed exploratory data analysis (EDA) on the true historical closing price data provided in `FINAL_USO.csv`. The analysis was visualized and supported by summary statistics, autocorrelation diagnostics, and rolling volatility indicators.

Below is a breakdown of the key observed features and the simulation components derived from them.

```{r}
# Load necessary libraries
library(tidyverse)
library(zoo)
library(lubridate)

# Load the data
df <- read_csv("FINAL_USO.csv")

# Convert date column
df <- df %>%
  mutate(Date = as.Date(Date)) %>%
  arrange(Date)

# Plot closing price
ggplot(df, aes(x = Date, y = Close)) +
  geom_line(color = "goldenrod", size = 0.5) +
  labs(
    title = "Gold-Like Closing Price (USD)",
    x = "Date",
    y = "Close Price (USD)"
  ) +
  theme_minimal(base_size = 14)

```

*The plot shows:*

-   *A **strong downward trend** from around 2012 to 2015*

-   *Followed by a **noisy sideways movement** with irregular fluctuations (2016–2019).*

-   ***No obvious seasonality** — you were right to say you don’t want it.*

-   *Short bursts of **volatility spikes** and mean reversion behavior.*

Observation:\
The time series exhibits a clear downward trend over the early segment (approx. 2012 to 2015), followed by a mostly horizontal wandering pattern afterward. This can be interpreted as a non-stationary process with a time-varying deterministic drift.

Modeling Recommendation:\
In simulation, this can be achieved using a piecewise drift function or a linearly declining deterministic trend. This approach is consistent with time-series modeling literature, where changing macroeconomic regimes or market sentiment are captured using time-varying drifts.

**Reference**:

-   Hamilton, J. D. (1994). *Time Series Analysis*. Princeton University Press.

EDA

```{r}
# Summary statistics
summary(df$Close)

```

*price mostly fluctuates between \$100 and \$175, with an average around \$127*

```{r}
#
# Calculate log returns
df <- df %>%
  mutate(Returns = log(Close / lag(Close)))

# Autocorrelation of returns
acf(na.omit(df$Returns), main = "ACF of Log Returns")
# Rolling mean and volatility
df <- df %>%
  mutate(
    RollingMean = rollmean(Close, k = 100, fill = NA, align = "right"),
    RollingVol = rollapply(Close, width = 100, FUN = sd, fill = NA, align = "right")
  )

# Plot rolling mean and volatility
ggplot(df, aes(x = Date)) +
  geom_line(aes(y = Close), color = "gray", alpha = 0.4) +
  geom_line(aes(y = RollingMean), color = "blue", size = 1) +
  labs(
    title = "Closing Price with 100-Day Rolling Mean",
    y = "Price"
  ) +
  theme_minimal()

ggplot(df, aes(x = Date, y = RollingVol)) +
  geom_line(color = "red", size = 1) +
  labs(
    title = "Rolling Volatility (100-Day Std Dev)",
    y = "Volatility"
  ) +
  theme_minimal()

```

*Return behaviour:*

-   *Autocorrelation of Returns: -0.0688 → very close to zero.*

    -   *This means daily returns are not strongly autocorrelated — consistent with a noisy or random process.*

    *Returns are noisy, suggesting we can use stochastic processes like Geometric Brownian Motion (GBM), but with drift adjustment and maybe volatility clustering.*

### *Rolling Behavior (100-day window)*

-   *Rolling Mean shows long-term trends.*

-   *Rolling Std Dev reveals volatility spikes (jumps in risk).*

-   *Suggests the price exhibits heteroskedasticity (i.e., volatility is not constant over time).*

### 2. **Volatility Clustering**

Observation:\
Though the returns themselves are weakly autocorrelated, the volatility of returns changes over time. There are periods of relative calm and periods of heightened fluctuation. This is a classic example of volatility clustering.

Modeling Recommendation:\
Incorporate heteroskedastic variance using a GARCH-like volatility model or simulate bursts of volatility using stochastic variance modulation.

**Reference**:

-    Engle, R. F. (1982). Autoregressive Conditional Heteroskedasticity with Estimates of the Variance of United Kingdom Inflation. *Econometrica*, 50(4), 987–1007.

### 3. **No Seasonality**

**Observation**:\
Visual inspection and autocorrelation plots reveal **no strong seasonal structure** in the time series. The price dynamics appear to be driven more by medium-term trends and volatility regimes than any fixed cyclical component.

**Modeling Recommendation**:\
Exclude any seasonal term (e.g., sine/cosine components or seasonal ARIMA). This aligns with prior work that shows commodity prices often lack deterministic seasonality unless storage or harvest cycles are involved — which is not present here.

**Reference**:

-   Cont, R. (2001). Empirical properties of asset returns: stylized facts and statistical issues. *Quantitative Finance*, 1(2), 223–236.

```{r}
set.seed(123)

# Length of series (same as real data)
n <- 1718
time <- 1:n

# Simulate underlying trend: initial rise and slow decay
trend <- 150 + 20 * exp(-time / 500) * sin(time / 80)

# Simulate cycles: slow and fast oscillations
cycle <- 10 * sin(time / 30) + 5 * sin(time / 10)

# Add heteroskedastic noise
noise <- cumsum(rnorm(n, mean = 0, sd = 0.5))  # random walk noise

# Combine components
simulated_price <- trend + cycle + noise

# Plot
plot(simulated_price, type = 'l', col = 'goldenrod', lwd = 1.2,
     main = "Simulated Gold-Like Closing Price",
     ylab = "Close Price (USD)", xlab = "Time Index (Daily)")


```
